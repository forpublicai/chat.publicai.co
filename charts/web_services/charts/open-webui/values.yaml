# Default values for open-webui
# This is the base configuration - override in values-prod.yaml

app:
  name: openwebui
  replicas: 2
  image:
    repository: ghcr.io/open-webui/open-webui
    tag: main
  port: 8080
  webuiUrl: "https://localhost:8080"
  vectorDb: pgvector
  enableVersionUpdateCheck: "false"
  
  # Affinity settings for production
  affinity:
    enabled: true
    hard: false  # Use soft anti-affinity for better scaling
  
  # Topology spread constraints
  topologySpreadConstraints:
    enabled: true
    maxSkew: 1
    whenUnsatisfiable: DoNotSchedule
  
  # Storage configuration
  storage:
    provider: s3
    s3:
      bucketName: my-bucket
      region: us-west-2
      keyPrefix: uploads/
  
  # Websocket configuration
  websocket:
    enabled: "true"
    manager: redis
  
  # Redis configuration
  redis:
    cluster: "true"
  
  # Authentication configuration
  auth:
    enableLoginForm: "true"
    enableSignupPasswordConfirmation: "true"
    enableOauthSignup: "true"
    enableOauthPersistentConfig: "false"
    oauthUpdatePictureOnLogin: "true"
    enableOauthRoleManagement: "false"
    enableOauthGroupManagement: "false"
    openidProviderUrl: "https://accounts.google.com/.well-known/openid-configuration"
    enableForwardUserInfoHeaders: "true"
    signoutRedirectUri: "https://localhost:8080"
  
  # Web Search configuration
  webSearch:
    enabled: "true"
    engine: "searxng"
    searxngQueryUrl: "http://searxng-service:8080/search?q=<query>"
  
  # Content Extraction configuration (Tika)
  contentExtraction:
    engine: "tika"
    tikaServerUrl: "http://tika-service:9998"
  
  # Resource configuration - minimal defaults
  resources:
    requests:
      memory: "1Gi"
      cpu: "500m"
    limits:
      memory: "2Gi"
      cpu: "1000m"

service:
  name: openwebui-service
  port: 8080
  type: ClusterIP

# Ingress removed - now handled by infrastructure chart

autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 4
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 80

serviceAccount:
  name: openwebui-sa
  roleArn: ""

secrets:
  name: web-services-secrets
  # These will be loaded from .env file using external script
  licenseKey: ""
  webuiSecretKey: ""
  databaseUrl: ""
  redisUrl: ""
  googleClientId: ""
  googleClientSecret: ""
  # oauthClientId: ""
  # oauthClientSecret: ""
  # openidProviderUrl: ""
  # openidRedirectUri: ""