# Default values for open-webui
# This is the base configuration - override in values-prod.yaml

app:
  name: openwebui
  replicas: 2
  image:
    repository: ghcr.io/open-webui/open-webui
    tag: main
  port: 8080
  webuiUrl: "https://app2.publicai.company"
  vectorDb: pgvector
  
  # Affinity settings for production
  affinity:
    enabled: true
    hard: false  # Use soft anti-affinity for better scaling
  
  # Topology spread constraints
  topologySpreadConstraints:
    enabled: true
    maxSkew: 1
    whenUnsatisfiable: DoNotSchedule
  
  # Storage configuration
  storage:
    provider: s3
    s3:
      bucketName: publicai-bucket
      region: eu-central-2
      keyPrefix: uploads/
  
  # Websocket configuration
  websocket:
    enabled: "true"
    manager: redis
  
  # Redis configuration
  redis:
    cluster: "true"
  
  # Authentication configuration
  auth:
    enableLoginForm: "false"
    enableSignupPasswordConfirmation: "true"
    enableOauthSignup: "false"
    oauthUpdatePictureOnLogin: "true"
    enableOauthRoleManagement: "true"
    enableOauthGroupManagement: "true"
    # openidProviderUrl now loaded from secret OPENID_PROVIDER_URL
    enableForwardUserInfoHeaders: "true"
    signoutRedirectUri: "https://app2.publicai.company"
  
  # Web Search configuration
  webSearch:
    enabled: "true"
    engine: "searxng"
    searxngQueryUrl: "http://searxng-service:8080/search?q=<query>"
  
  # Content Extraction configuration (Tika)
  contentExtraction:
    engine: "tika"
    tikaServerUrl: "http://tika-service:9998"
  
  # Resource configuration (optimized for 4GB nodes)
  resources:
    requests:
      memory: "2Gi"
      cpu: "900m"
    limits:
      memory: "3Gi"
      cpu: "1500m"

service:
  name: openwebui-service
  port: 8080
  type: ClusterIP

# Ingress removed - now handled by infrastructure chart

autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 8
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 80

serviceAccount:
  name: openwebui-sa
  roleArn: arn:aws:iam::901779868336:role/OpenWebUI-IRSA-Role

secrets:
  name: web-services-secrets
  # These will be loaded from .env file using external script
  licenseKey: ""
  webuiSecretKey: ""
  databaseUrl: ""
  redisUrl: ""
  googleClientId: ""
  googleClientSecret: ""
  # oauthClientId: ""
  # oauthClientSecret: ""
  # openidProviderUrl: ""
  # openidRedirectUri: ""